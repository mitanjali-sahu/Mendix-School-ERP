!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e(require("react"),require("dojo/aspect"),require("mendix/lang"),require("dijit/registry"),require("dojo/_base/connect"));else if("function"==typeof define&&define.amd)define(["react","dojo/aspect","mendix/lang","dijit/registry","dojo/_base/connect"],e);else{var r="object"==typeof exports?e(require("react"),require("dojo/aspect"),require("mendix/lang"),require("dijit/registry"),require("dojo/_base/connect")):e(t.react,t["dojo/aspect"],t["mendix/lang"],t["dijit/registry"],t["dojo/_base/connect"]);for(var i in r)("object"==typeof exports?exports:t)[i]=r[i]}}(window,function(t,e,r,i,o){return function(t){var e={};function r(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(i,o,function(e){return t[e]}.bind(null,o));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/",r(r.s=22)}([function(e,r){e.exports=t},function(t,e,r){var i;
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
!function(){"use strict";var r={}.hasOwnProperty;function o(){for(var t=[],e=0;e<arguments.length;e++){var i=arguments[e];if(i){var n=typeof i;if("string"===n||"number"===n)t.push(i);else if(Array.isArray(i)&&i.length){var a=o.apply(null,i);a&&t.push(a)}else if("object"===n)for(var s in i)r.call(i,s)&&i[s]&&t.push(s)}}return t.join(" ")}t.exports?(o.default=o,t.exports=o):void 0===(i=function(){return o}.apply(e,[]))||(t.exports=i)}()},function(t,e,r){var i;void 0===(i=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t.parseStyle=function(t){void 0===t&&(t="");try{return t.split(";").reduce(function(t,e){var r=e.split(":");2===r.length&&(t[r[0].trim().replace(/(-.)/g,function(t){return t[1].toUpperCase()})]=r[1].trim());return t},{})}catch(e){window.console.log("Failed to parse style",t,e)}return{}},t.validateCompatibility=function(t){var e=t.listViewEntity,r=t.targetListView,i=r&&r.datasource&&r.datasource.type;if(!r){var o="This widget is unable to find a list view ";return o+=e?"with the supplied entity '"+e+"'":"to connect"}return i&&"database"!==i&&"xpath"!==i?"This widget is only compatible with list view data source type 'Database' and 'XPath'":r&&r._datasource&&r._entity&&r.update?r._entity&&void 0!==e&&e!==r._entity?'The supplied entity "'+t.listViewEntity+'" does not belong to list view data source':"":"This widget version is not compatible with this Mendix version"},t.findTargetNode=function(t){for(var e=null;!e&&t&&!((e=t.querySelectorAll(".mx-listview")[0])||t.isEqualNode(document)||!t.classList||t.classList.contains("mx-incubator")||t.classList.contains("mx-offscreen"));)t=t.parentNode;return e},t}();e.SharedUtils=r}.apply(e,[r,e]))||(t.exports=i)},function(t,e,r){var i,o;i=[r,e,r(9)],void 0===(o=function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){}return t.findTargetListView=function(t,e){for(var i;t;){for(var o=t.querySelectorAll(".mx-listview"),n=0;n<o.length;n++){if((i=r.byNode(o.item(n)))&&!e)return i;if(i&&i._entity===e)return i}if(t.isEqualNode(document)||!t.classList||t.classList.contains("mx-incubator")||t.classList.contains("mx-offscreen"))break;t=t.parentNode}return i},t}();e.SharedContainerUtils=i}.apply(e,i))||(t.exports=o)},function(t,r){t.exports=e},function(t,e,r){var i;void 0===(i=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.hideLoadMoreButton=function(t){t&&t.classList.add("hide-load-more")},e.showLoadMoreButton=function(t){t&&t.domNode.classList.remove("hide-load-more")},e.resetListViewHeight=function(t){var e=t.querySelector("ul");e.style.removeProperty("height"),e.style.removeProperty("overflow")},e.persistListViewHeight=function(t){var e=t.querySelector("ul");e.offsetHeight>0&&(e.style.height=e.offsetHeight+"px",e.style.overflow="hidden")},e.getListNode=function(t){return t.querySelector("ul")},e.setListNodeToEmpty=function(t){logger.debug("setListNodeToEmpty");for(var e=t.querySelector("ul");e.firstChild;)e.removeChild(e.firstChild)},e.showLoader=function(t){logger.debug("showLoader"),t.domNode.classList.add("widget-pagination-loading")},e.hideLoader=function(t){logger.debug("hideLoader"),t.domNode.classList.remove("widget-pagination-loading")},e.mxTranslation=function(t,e,r){var i=mx.session.getConfig("uiconfig.translations."+t+"."+e)||window.mx.session.getConfig("uiconfig.translations")[t+"."+e]||"[No translation]";return r.reduce(function(t,e,r){return t.split("{"+(r+1)+"}").join(e)},i)}}.apply(e,[r,e]))||(t.exports=i)},function(t,e){t.exports=r},function(t,e,r){var i,o;i=[r,e,r(0),r(1)],void 0===(o=function(t,e,r,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Alert=function(t){var e=t.bootstrapStyle,o=t.className,n=t.children;return n?r.createElement("div",{className:i("alert alert-"+e,o)},n):null},e.Alert.displayName="Alert",e.Alert.defaultProps={bootstrapStyle:"danger"}}.apply(e,i))||(t.exports=o)},function(t,e,r){var i,o;i=[r,e,r(4),r(2),r(3),r(5),r(10),r(38)],void 0===(o=function(t,e,r,i,o,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t){this.initialLoad=!0,this.delay=50,this.store={constraints:{_none:{}},sorting:{}},this.updateInProgress=!1,this.requiresUpdate=!1,this.sorting=[],this.constraints=[],this.widget=t,this.originalSort=window.mx.isOffline()?this.widget._datasource._sort:this.widget._datasource._sorting,r.after(t,"storeState",function(e){logger.debug("after storeState"),t.__customWidgetDataSourceHelper&&(e("lvcSorting",t.__customWidgetDataSourceHelper.sorting),e("lvcConstraints",t.__customWidgetDataSourceHelper.constraints),e("lvcPaging",t.__customWidgetDataSourceHelper.paging))},!0)}return t.getInstance=function(e,r){var n=e&&e.parentElement,a=o.SharedContainerUtils.findTargetListView(n,r),s=i.SharedUtils.validateCompatibility({listViewEntity:r,targetListView:a});if(!s&&a)return a.__customWidgetDataSourceHelper||(a.__customWidgetDataSourceHelper=new t(a)),a.getState("lvcPersistState",!1)||this.hideContent(a.domNode),a.__customWidgetDataSourceHelper;throw new Error(s)},t.prototype.setSorting=function(t,e,r){void 0===r&&(r=!1),this.store.sorting={},this.store.sorting[t]=e,this.registerUpdate(r)},t.prototype.setConstraint=function(t,e,r,i){var o;void 0===r&&(r="_none"),void 0===i&&(i=!1);var n=r.trim()||"_none";this.store.constraints[n]?this.store.constraints[n][t]=e:this.store.constraints[n]=((o={})[t]=e,o),this.registerUpdate(i)},t.prototype.getListView=function(){return this.widget},t.prototype.registerUpdate=function(t){var e=this;logger.debug("DataSourceHelper .registerUpdate"),this.timeoutHandle&&window.clearTimeout(this.timeoutHandle),this.updateInProgress?this.requiresUpdate=!0:this.timeoutHandle=window.setTimeout(function(){logger.debug("DataSourceHelper .execute"),e.updateInProgress=!0,e.iterativeUpdateDataSource(t)},this.delay)},t.prototype.iterativeUpdateDataSource=function(t){var e=this;this.updateDataSource(function(){e.requiresUpdate?(e.requiresUpdate=!1,e.iterativeUpdateDataSource(t)):e.updateInProgress=!1},t)},t.prototype.updateDataSource=function(e,r){var i=this,o=[],n=Object.keys(this.store.sorting).map(function(t){return i.store.sorting[t]}).filter(function(t){return t[0]&&t[1]});if(n.length||(n=this.originalSort),window.mx.isOffline()){for(var a=Object.keys(this.store.constraints._none).map(function(t){return i.store.constraints._none[t]}),s=a.filter(function(t){return t.value}),u=a.filter(function(t){return t.operator}),c=[],d=0,l=Object.keys(this.store.constraints).filter(function(t){return"_none"!==t});d<l.length;d++){for(var p=l[d],f=[],h=0,g=Object.keys(this.store.constraints[p]);h<g.length;h++){var y=g[h],v=this.store.constraints[p][y];v&&v.value&&f.push(v)}f.length&&c.push({constraints:f,operator:"or"})}o=s.concat(u,c)}else{o=(s=Object.keys(this.store.constraints._none).map(function(t){return i.store.constraints._none[t]}).join(""))+(c=Object.keys(this.store.constraints).filter(function(t){return"_none"!==t}).map(function(t){return"["+Object.keys(i.store.constraints[t]).map(function(e){return i.store.constraints[t][e]}).filter(function(t){return t}).map(function(t){return t.trim().substr(1,t.trim().length-2)}).join(" or ")+"]"}).join("").replace(/\[]/g,""))}this.sorting=n,this.constraints=o,r?(t.showContent(this.widget.domNode),this.hideLoader(),this.initialLoad=!1,e()):(this.widget._datasource._constraints=o,window.mx.isOffline()?this.widget._datasource._sort=n:this.widget._datasource._sorting=n,logger.debug("DataSourceHelper .set sort and constraint"),this.initialLoad||this.showLoader(),this.widget.update(null,function(){logger.debug("DataSourceHelper .updated"),i.hideLoader(),i.initialLoad=!1,e()}))},t.prototype.showLoader=function(){this.widget.domNode.classList.add("widget-data-source-helper-loading")},t.hideContent=function(t){t&&t.classList.add("widget-data-source-helper-initial-loading")},t.showContent=function(t){t&&t.classList.remove("widget-data-source-helper-initial-loading")},t.prototype.hideLoader=function(){this.widget.domNode.classList.remove("widget-data-source-helper-loading"),t.showContent(this.widget.domNode)},t.prototype.setPaging=function(t,e){var r=this,i=this.widget._datasource;if(!this.widget.__customWidgetPagingLoading){var o=!1;void 0!==t&&t!==i.getOffset()&&(this.widget.__customWidgetPagingOffset=t,i.setOffset(t),o=!0),void 0!==e&&e!==i.getPageSize()&&(i.setPageSize(e),o=!0),this.paging={pageSize:void 0!==e?e:i.getPageSize(),offset:void 0!==t?t:i.getOffset()},o&&(logger.debug(".updateDatasource changed",t,e),this.widget.__customWidgetPagingLoading=!0,this.showLoader(),this.widget.sequence(["_sourceReload","_renderData"],function(){r.widget.__customWidgetPagingLoading=!1,n.resetListViewHeight(r.widget.domNode),logger.debug(".updateDatasource updated"),r.hideLoader()}))}},t}();e.DataSourceHelper=a}.apply(e,i))||(t.exports=o)},function(t,e){t.exports=i},function(t,e,r){var i;void 0===(i=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(){var t=mxui.widget.ListView;function e(t){if(!(!t||"database"===t.datasource.type||"xpath"===t.datasource.type))return!1;var e=!!(t&&("database"===t.datasource.type||"xpath"===t.datasource.type)&&t._datasource&&t._datasource.reload&&t._datasource.setOffset&&t._datasource.setPageSize&&void 0!==t._datasource._constraints&&(t._datasource._sorting||t._datasource._sort)&&t._datasource.getSetSize&&t._datasource.getOffset);return e||logger.error("This Mendix version is not compatible with list view controls. The List view controls use is limited."),e}!t.prototype.__lvcPrototypeUpdated&&function(t){var e=!!(t&&t.postCreate&&t._loadData&&t.getState&&t._onLoad&&t._renderData);e||logger.error("This Mendix version is not compatible with list view controls. The List view prototype could not be updated.");return e}(t.prototype)?(t.prototype.__lvcPrototypeUpdated=!0,t.prototype.__postCreateOriginal=t.prototype.postCreate,t.prototype.postCreate=function(){if(logger.debug("list view control, overwrites postCreate prototype"),this.__postCreateOriginal(),e(this)){var t=this.getState("lvcPaging");t&&(void 0!==t.offset&&this._datasource.setOffset(t.offset),void 0!==t.pageSize&&this._datasource.setPageSize(t.pageSize));var r=this.getState("lvcSorting");r&&(this._datasource._sorting=r);var i=this.getState("lvcConstraints");i&&(this._datasource._constraints=i)}},t.prototype.__loadDataOriginal=t.prototype._loadData,t.prototype._loadData=function(t){var r=this;logger.debug("List view control, overwrites _loadData prototype"),e(this)?(this.__lvcPagingEnabled&&this._datasource.setOffset(0),this._datasource.reload(function(){var e=r._datasource.getOffset();if(e&&r._datasource.getSetSize()<=e)return r._datasource.setOffset(0),void r._loadData(t);r._renderData(function(){r._onLoad(),t&&t()})})):this.__loadDataOriginal(t)}):logger.debug("Prototype update called unexpected again")}()}.apply(e,[r,e]))||(t.exports=i)},function(t,e,r){var i,o;i=[r,e,r(12)],void 0===(o=function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e,i){this.form=t,this.widgetId=e,this.persistHandle=r.connect(t,"onPersistViewState",null,function(t){var r=t[e]||(t[e]={});i(r)})}return t.prototype.getPageState=function(t,e){var r=this.form,i=r&&r.viewState?r.viewState[this.widgetId]:void 0,o=i&&void 0!==i[t]?i[t]:e;return logger.debug("getPageState",this.widgetId,t,e,o),o},t.prototype.destroy=function(){r.disconnect(this.persistHandle)},t}();e.FormViewState=i}.apply(e,i))||(t.exports=o)},function(t,e){t.exports=o},,,,,,,,,,function(t,e,r){var i,o,n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});i=[r,e,r(0),r(6),r(1),r(7),r(8),r(2),r(23),r(24),r(3),r(11)],void 0===(o=function(t,e,r,i,o,n,s,u,c,d,l,p){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var f=function(t){function e(e){var r=t.call(this,e)||this;r.widgetDom=null,r.retriesFind=0,r.applySearch=r.applySearch.bind(r);var i=r.props.uniqueid||r.props.friendlyId;return r.viewStateManager=new p.FormViewState(r.props.mxform,i,function(t){t.defaultSearchText=r.state.searchText}),r.state={alertMessage:d.Validate.validateProps(r.props),searchText:r.getDefaultValue(),listViewAvailable:!1},r}return a(e,t),e.prototype.render=function(){var t=this;return r.createElement("div",{className:o("widget-text-box-search",this.props.class),ref:function(e){return t.widgetDom=e},style:u.SharedUtils.parseStyle(this.props.style)},r.createElement(n.Alert,{className:"widget-text-box-search-alert"},this.state.alertMessage),this.renderTextBoxSearch())},e.prototype.componentDidMount=function(){i.delay(this.connectToListView.bind(this),this.checkListViewAvailable.bind(this),20)},e.prototype.componentDidUpdate=function(t,e){this.state.listViewAvailable&&!e.listViewAvailable&&this.applySearch(this.state.searchText)},e.prototype.checkListViewAvailable=function(){return!!this.widgetDom&&(this.retriesFind++,this.retriesFind>25||!!l.SharedContainerUtils.findTargetListView(this.widgetDom.parentElement,this.props.entity))},e.prototype.renderTextBoxSearch=function(){return this.state.alertMessage?null:r.createElement(c.TextBoxSearch,{defaultQuery:this.state.searchText,onTextChange:this.applySearch,placeholder:this.props.placeHolder})},e.prototype.applySearch=function(t){var e=this.getConstraint(mxui.dom.escapeHTMLQuotes(t));this.dataSourceHelper&&this.dataSourceHelper.setConstraint(this.props.friendlyId,e),this.setState({searchText:t})},e.prototype.getConstraint=function(t){var e=this;if(!(t=t.trim()))return"";if(window.mx.isOffline()){var r=[];return this.props.attributeList.forEach(function(i){r.push({attribute:i.attribute,operator:"contains",path:e.props.entity,value:t})}),{constraints:r,operator:"or"}}var i=[];return this.props.attributeList.forEach(function(e){i.push("contains("+e.attribute+",'"+t+"')")}),"["+i.join(" or ")+"]"},e.prototype.connectToListView=function(){var t=this.state.alertMessage||"";try{this.dataSourceHelper=s.DataSourceHelper.getInstance(this.widgetDom,this.props.entity)}catch(e){t=e.message}this.setState({alertMessage:t,listViewAvailable:!t})},e.prototype.getDefaultValue=function(){return this.viewStateManager.getPageState("defaultSearchText",this.props.defaultQuery)},e}(r.Component);e.default=f}.apply(e,i))||(t.exports=o)},function(t,e,r){var i,o,n,a=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});i=[r,e,r(0),r(51)],void 0===(o=function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.searchTimeOut=500,e.resetQueryHandle=e.resetQuery.bind(e),e.onChangeHandle=e.onChange.bind(e),e.state={query:e.props.defaultQuery},e}return a(e,t),e.prototype.render=function(){return r.createElement("div",{className:"search-bar"},r.createElement("input",{className:"form-control",onChange:this.onChangeHandle,placeholder:this.props.placeholder,value:this.state.query}),this.renderReset())},e.prototype.componentWillReceiveProps=function(t){this.state.query!==t.defaultQuery&&this.setState({query:t.defaultQuery})},e.prototype.onChange=function(t){var e=this,r=t.currentTarget.value;this.state.query!==r&&(this.updateHandle&&window.clearTimeout(this.updateHandle),this.updateHandle=window.setTimeout(function(){e.props.onTextChange(r)},this.searchTimeOut)),this.setState({query:r})},e.prototype.renderReset=function(){return this.state.query?r.createElement("button",{className:"btn-transparent visible",onClick:this.resetQueryHandle},r.createElement("span",{className:"glyphicon glyphicon-remove"})):null},e.prototype.resetQuery=function(){this.setState({query:""}),this.props.onTextChange("")},e}(r.Component);e.TextBoxSearch=i}.apply(e,i))||(t.exports=o)},function(t,e,r){var i,o;i=[r,e,r(0)],void 0===(o=function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){}return t.validateProps=function(t){var e=[];return!t.isWebModeler&&window.mx.isOffline()&&t.attributeList.forEach(function(t,r){t.attribute.indexOf("/")>-1&&e.push("'Search attribute' at position {"+(r+1)+"} over reference is not supported in offline application")}),e.length?r.createElement("div",{},"Configuration error in widget:",e.map(function(t,e){return r.createElement("p",{key:e},t)})):""},t}();e.Validate=i}.apply(e,i))||(t.exports=o)},,,,,,,,,,,,,,function(t,e){},,,,,,,,,,,,,function(t,e){}])});